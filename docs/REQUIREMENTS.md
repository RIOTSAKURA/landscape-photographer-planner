# 风光摄影师出行规划器 - 需求文档

> 文档版本：v0.4
> 更新日期：2026-02-27
> 状态：草案（待完善）

---

## 1. 项目概述

### 1.1 项目名称
Landscape Photographer Planner（风光摄影师出行规划器）

### 1.2 项目简介
一款面向风光摄影师和摄影爱好者的智能出行规划工具。根据用户输入的多个目的地、日期范围和交通方式，智能生成推荐路线，并提供沿途景点的天气预测、最佳拍摄时间、推荐机位和器材建议。

### 1.3 部署模式
| 版本 | 模式 | 说明 |
|-----|------|------|
| **第一版** | 轻量级本地部署 | 单用户使用，无需登录，数据存储在本地数据库 |
| 后续版本 | 多用户云部署 | 支持用户注册登录，云端数据同步 |

### 1.4 目标用户
| 用户类型 | 描述 | 核心需求 |
|---------|------|---------|
| 专业风光摄影师 | 以摄影为主要收入来源，追求高质量作品 | 精准机位推荐、专业器材建议、黄金时段规划 |
| 摄影爱好者/旅行者 | 热爱摄影的旅行者，希望拍出好照片 | 简单易用、景点推荐、基础拍摄指导 |

### 1.4 运行平台
| 阶段 | 平台 | 说明 |
|-----|------|------|
| 第一版 | Web 应用 | 响应式设计，支持桌面和平板 |
| 后续扩展 | 移动端 App | iOS / Android |

### 1.5 付费模式
| 功能类型 | 说明 |
|---------|------|
| 核心功能 | ✅ 免费（路线规划、天气查询、拍摄建议） |
| 付费功能 | 🔒 预留（高级功能，后续定义） |

---

## 2. 功能需求

### 2.1 用户系统（后续扩展）

> ⚠️ **第一版说明**：用户系统预留但不实现。第一版为轻量级本地部署，无需登录即可使用全部功能。所有行程数据归属于单一用户（本地部署用户）。

#### 2.1.1 注册与登录（后续扩展）
- [ ] 邮箱注册
- [ ] 密码登录
- [ ] 忘记密码功能
- [ ] ~~第三方登录~~（后续扩展）

#### 2.1.2 用户资料（后续扩展）
- [ ] 基本信息管理（昵称、头像）
- [ ] 摄影水平标签（入门/进阶/专业）
- [ ] 器材信息（可选，用于更精准的器材推荐）

### 2.2 行程规划

#### 2.2.1 输入信息
| 输入项 | 类型 | 说明 |
|-------|------|------|
| 目的地列表 | 多个地点 | 用户想要拍摄的多个景点/城市 |
| 日期范围 | 日期区间 | 出行开始和结束日期 |
| 交通方式 | 单选 | 自驾 / 公共交通 / 混合 |

#### 2.2.2 路线生成
- [ ] 智能排序景点顺序（考虑距离、交通、最佳拍摄时间）
- [ ] 计算每个景点的建议停留时间
- [ ] 生成可视化路线地图
- [ ] 支持手动调整顺序

#### 2.2.3 景点详情
- [ ] 景点基本信息（名称、位置、描述）
- [ ] 推荐机位（经典拍摄点）
- [ ] 最佳拍摄时间段（黄金时段、蓝调时刻等）
- [ ] 景点照片参考

### 2.3 天气预测

#### 2.3.1 天气数据
根据预计到达时间，显示对应景点在对应时间的天气：

| 数据类型 | 指标 | 对拍摄的影响 |
|---------|------|-------------|
| 基础天气 | 温度（最高/最低/体感）、天气状况（晴/多云/阴/雨/雪） | 决定着装和拍摄题材 |
| 云量 | 百分比数值 | 判断光线条件、云层层次 |
| 风 | 风速、风向、风力等级 | 影响长曝光稳定性 |
| 能见度 | 公里数 | 影响远景清晰度 |
| 降水 | 降水量 | 判断是否需要防护 |
| 紫外线 | 紫外线强度指数 | 户外活动参考 |
| 气压 | 大气压强 | 天气变化趋势 |

#### 2.3.2 天象数据
| 数据类型 | 说明 | 对拍摄的影响 |
|---------|------|-------------|
| 日出日落时间 | 未来 30 天 | 黄金时段、蓝调时刻规划 |
| 月升月落时间 | 未来 30 天 | 夜景、月光拍摄 |
| 月相 | 逐小时月相数据 | 银河拍摄、月光影响 |
| 太阳高度角 | 任意时间点 | 光线角度分析 |

#### 2.3.3 天气与拍摄建议关联
| 天气条件 | 拍摄建议示例 |
|---------|-------------|
| 晴朗 | 适合日出日落、黄金时段拍摄，建议使用滤镜 |
| 多云 | 柔和光线，适合人像、风光，云层可增加画面层次 |
| 阴天 | 光线平淡，适合拍摄瀑布、森林等不需要强光的场景 |
| 雨天 | 雨景、倒影、雾气效果，注意器材防护 |
| 雪天 | 雪景、极简构图，注意曝光补偿和白平衡 |

### 2.4 拍摄建议

#### 2.4.1 建议内容
- [ ] 基于地点的特色拍摄建议
- [ ] 基于时间段的光线条件建议
- [ ] 基于天气的拍摄策略调整
- [ ] 器材推荐：
  - 推荐焦段
  - 推荐滤镜（ND/GND/CPL）
  - 三脚架建议
  - 其他配件（快门线、防雨罩等）

#### 2.4.2 个性化推荐
- [ ] 根据用户摄影水平调整建议详细程度
- [ ] 根据用户已有器材优化推荐

### 2.5 历史记录

- [ ] 保存所有规划记录
- [ ] 按时间/地点分类查看
- [ ] 复用历史规划（复制为新的行程）
- [ ] 导出行程（PDF/图片格式，待定）

### 2.6 社交功能（后续扩展）
- [ ] 分享行程给其他用户
- [ ] 查看他人公开的行程
- [ ] 景点评价和机位分享

---

## 3. 非功能需求

### 3.1 性能要求
- 路线生成响应时间 < 5 秒
- 天气数据加载时间 < 3 秒
- 支持并发用户数：待定

### 3.2 兼容性
- **当前阶段**：Web 应用
  - 支持 Chrome、Safari、Firefox、Edge 最新版本
  - 响应式设计，适配桌面和平板
- **后续扩展**：移动端 App（iOS/Android）

### 3.3 数据安全
- 用户密码加密存储
- 个人信息保护
- 数据备份机制

---

## 4. 技术架构

### 4.1 外部 API 服务

#### 4.1.1 地图服务 - 高德地图 API
| 功能 | API | 说明 |
|-----|-----|------|
| 地点搜索 | POI 搜索 API | 关键字搜索、周边搜索 |
| 路线规划 | 驾车/步行/公交路线规划 | 根据交通方式选择 |
| 地图展示 | Web JS API | 地图可视化 |
| POI 数据 | POI 详情 API | 景点基础信息、评分、照片 |

**高德地图提供的数据：**
- ✅ 景点名称、地址、经纬度
- ✅ 景点评分、照片
- ✅ 商圈信息、联系方式
- ❌ 拍摄机位（需自建）
- ❌ 最佳拍摄时间（需自建）

#### 4.1.2 天气服务 - 和风天气 API（主）
| 功能 | API | 说明 |
|-----|-----|------|
| 实时天气 | /weather/now | 当前天气状况 |
| 天气预报 | /weather/3d, /7d, /15d, /30d | 未来 3-30 天预报 |
| 日出日落 | /astronomy/sunrise | 太阳升降时间 |
| 月升月落 | /astronomy/moon | 月亮升降和月相 |
| 太阳高度角 | /astronomy/solar-elevation | 任意时间点太阳角度 |

**和风天气提供的数据：**
- ✅ 温度、体感温度、天气状况
- ✅ 云量（百分比）
- ✅ 风速、风向、风力等级
- ✅ 能见度、降水量、气压、紫外线
- ✅ 日出日落、月升月落、月相
- ✅ 太阳高度角
- ✅ 国内访问稳定

#### 4.1.3 天气服务 - Windy API（备选）
用于国际地点或需要更详细气象数据时切换。

#### 4.1.4 摄影数据 - 自建数据库
| 数据类型 | 说明 | 来源 |
|---------|------|------|
| 拍摄机位 | 经典拍摄点坐标、机位描述 | 人工整理/用户贡献 |
| 最佳拍摄时间 | 景点特色时段（日出/日落/蓝调） | 人工整理 |
| 拍摄建议 | 基于景点特色的拍摄技巧 | 人工整理 |
| 器材推荐 | 基于场景的器材建议 | 人工整理 |

### 4.2 数据来源策略

```
┌─────────────────────────────────────────────────────────────┐
│                      景点数据架构                            │
├─────────────────────────────────────────────────────────────┤
│  高德地图 API（基础数据）                                     │
│  ├── 景点名称、地址、经纬度                                   │
│  ├── 评分、照片                                              │
│  └── 商圈信息                                                │
├─────────────────────────────────────────────────────────────┤
│  自建数据库（摄影专属数据）                                    │
│  ├── 拍摄机位（坐标 + 描述 + 照片）                           │
│  ├── 最佳拍摄时段（季节/时间/天气条件）                        │
│  ├── 拍摄建议（技巧/注意事项）                                │
│  └── 器材推荐（焦段/滤镜/配件）                               │
└─────────────────────────────────────────────────────────────┘
```

---

## 5. 技术选型（已确认）

### 5.1 技术栈

| 层级 | 技术方案 | 说明 |
|-----|---------|------|
| **前端框架** | React 18 + Vite | 现代化开发体验 |
| **UI 方案** | Tailwind CSS + shadcn/ui | 灵活、轻量、美观 |
| **后端框架** | Node.js + NestJS | TypeScript、模块化、企业级 |
| **数据库** | PostgreSQL + PostGIS | 支持地理数据 |
| **地图服务** | 高德地图 JS API | 国内首选 |
| **天气服务** | 和风天气 API | 数据全面、国内稳定 |

### 5.2 架构模式

| 架构类型 | 说明 |
|---------|------|
| 单体应用 | 模块化组织，后期可拆分 |

```
┌─────────────────────────────────────────┐
│  前端（React + Vite + Tailwind）         │
└─────────────────────────────────────────┘
                    │
                    ▼
┌─────────────────────────────────────────┐
│  后端（NestJS）                          │
│  ├── Controller 层（接收请求）           │
│  ├── Service 层（业务逻辑）              │
│  └── Repository 层（数据访问）           │
└─────────────────────────────────────────┘
          │           │           │
          ▼           ▼           ▼
    ┌──────────┐ ┌──────────┐ ┌──────────┐
    │PostgreSQL│ │ 高德 API │ │和风天气API│
    └──────────┘ └──────────┘ └──────────┘
```

### 5.3 首批覆盖区域

| 区域 | 说明 |
|-----|------|
| 云南省 | 首批景点数据覆盖范围 |

---

## 6. 待确认事项

> 以下问题需要进一步讨论确认：

- [ ] **多语言支持**：是否需要国际化？
- [ ] **离线功能**：是否需要离线查看行程？
- [ ] **API 配额**：高德/和风天气 API 调用次数限制，需要评估预算
- [ ] **API Key 申请**：需要申请高德和和风天气的开发者账号

---

## 6. 里程碑规划

| 阶段 | 内容 | 状态 |
|-----|------|------|
| Phase 1 | 需求设计 | ✅ 进行中 |
| Phase 2 | 技术选型 & 架构设计 | 待开始 |
| Phase 3 | 核心功能开发 | 待开始 |
| Phase 4 | 测试 & 优化 | 待开始 |
| Phase 5 | 部署上线 | 待开始 |

---

## 8. 更新记录

| 日期 | 版本 | 更新内容 |
|-----|------|---------|
| 2026-02-26 | v0.1 | 初始草案 |
| 2026-02-26 | v0.2 | 确认技术方案：高德地图 + 和风天气 + 自建摄影数据 |
| 2026-02-26 | v0.3 | 确认技术栈：React+NestJS+PostgreSQL；单体架构；首批覆盖云南 |
| 2026-02-27 | v0.4 | 调整第一版定位为轻量级本地部署；用户系统标记为后续扩展 |
